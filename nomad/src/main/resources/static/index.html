<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<link rel="stylesheet" type="text/css" href="css/normalize.css">
<link rel="stylesheet" type="text/css" href="css/skeleton.css">
<link rel="stylesheet" type="text/css" href="css/index.css">

<link href='https://fonts.googleapis.com/css?family=Roboto'
	rel='stylesheet'>
<link
	href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;800&display=swap"
	rel="stylesheet">
<link rel="stylesheet" href="fontawesome/css/font-awesome.min.css">

<title>Nomad</title>
</head>
<body>
	<div id="app" class="content">
        <router-view></router-view>
        <router-link to="/admin">Test</router-link>
    </div>

    <script src="js/vue.js"></script>
    <script src="js/vue-router.js"></script>
    <script src="js/axios.min.js"></script>
    <script src="js/v-calendar.min.js"></script>
    <script src="js/httpVueLoader.js"></script>
    <script>
    	Vue.use(httpVueLoader);

        // NOTE(Jovan): Component registration
    	Vue.component("main-navigation", httpVueLoader("components/MainNavigation.vue"));
    	Vue.component("floating-label", httpVueLoader("components/FloatingLabel.vue"),
            {
               props: ["placeholder", "name", "type", "inputdata", "readonly",],
            });
        Vue.component("sidebar", httpVueLoader("components/Sidebar.vue"),
            {
                props: ["title", "user",],
            });

        // NOTE(Jovan): Route registration
        const routes =
        [
            {
                path: "/",
                name: "Home",
                component: httpVueLoader("components/Home.vue")
            },
            {
                path: "/login",
                name: "Login",
                component: httpVueLoader("components/Login.vue")
            },
            {
                path: "/registration",
                name: "Registration",
                component: httpVueLoader("components/Registration.vue")
            },
            {
                path: "/personal_data",
                name: "PersonalData",
                component: httpVueLoader("components/PersonalData.vue")
            },
            {
                path: "/amenities",
                name: "Amenities",
                component: httpVueLoader("components/Amenities.vue")
            },
            {
                path: "/hosts_guests",
                name: "ShowGuests",
                component: httpVueLoader("components/ShowGuests.vue")
            },
            {
                path: "/admin",
                name: "Admin",
                component: httpVueLoader("components/AdminPanel.vue"),
                children:
                [
                    {
                        path: "",
                        name: "Overview",
                        component: httpVueLoader("components/AdminOverview.vue"),
                    },
                   	{
                    	path: "amenities",
                    	name: "Amenities",
                    	component: httpVueLoader("components/Amenities.vue"),
                   	},
                ],
            },
            {
                path: "/guests_reservations",
                name: "GuestsReservations",
                component: httpVueLoader("components/GuestsReservations.vue")
            },
        ];

        const router = new VueRouter
        ({
            routes: routes,
        });

        new Vue
        ({
            el: "#app",
            router: router,
            data:
            {
                modal_active: false,
            },
            components:
           	{
           	},
            methods:
            {
                
                logout: function()
                {
                    let jwt = localStorage.jwt;
                    if(jwt){
                        localStorage.removeItem("jwt");
                        alert("You have successfully logged out");
                    } else {
                        alert("You are not logged in");
                    }
                },
                verify: function()
                {
                    var jwt = localStorage.jwt;
                    if(!jwt)
                    {
                        // NOTE(Jovan): Ako ne postoji jwt, ne pokusavaj login
                        return;
                    }
                    axios.get("rest/test", {headers:{"Authorization": "Bearer " + jwt}})
                        .then(response =>
                        {
                            this.loggedIn = true;
                        })
                        .catch(response =>
                        {
                            this.loggedIn = false;
                        });
                },
            },
            computed:
            {
                verifyLogin: function()
                {
                    return this.verify();
                }
            },
        }).$mount("#app");
    </script>

</body>
</html>
